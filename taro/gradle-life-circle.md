---
layout: page
title: gradle生命周期
parent: taro
---

[原文](https://docs.gradle.org/current/userguide/build_lifecycle.html)

### gradle 构建的生命周期

## 构建阶段

- 构建部分有三个生命周期
- 第一个初始化阶段，Gradle 支持单个或者多个项目的编译，在初始化阶段，Gradle 会决定哪个项目会参与当前的编译，并为每一个项目创建一个实例
- 配置阶段，在这个阶段项目实例会被配置，所有本次构建的项目的构建脚本将会被执行
- 执行阶段， Gradle 决定在配置阶段被创建和配置的任务子集去执行，子集由 gradle 启动时传递的任务参数和运行目录决定，最终 Gradle 会执行每一个任务

## 配置文件

除了编译脚本，Gradle 定义了很多设置文件。这些设置文件通过 Gradle 的命名约定决定。默认的文件名为`settings.gradle`。之后我们将介绍 Gradle 如何虚招设置文件

设置文件在初始化阶段会被执行。多项目的构建必须在根目录有一个`settings.gradle`文件。这个文件需要决定哪些项目参与编译，所以是必须的。对于单一项目的编译，配置文件时可选的。另外定义包含的项目，开发者还需要增加对应的库到编译脚本的 classpath 中。

### 初始化

Gradle 如何知道开发者需要编译单个项目还是多个项目？ 如果开发者在有`settings.gradle`的目录中出发了一个编译项目，Gradle 使用他来配置编译。Gradle 也允许开发者在热河的子项目中执行编译。如果在一个没有`settings.gradle`文件的子项目中执行编译，Gradle 会按照下面方式查找文件：

- 在父文件夹下查找`settings.gradle`
- 如果没找到，当做单一项目编译
- 如果找到了，gradle 会确认当前的项目是不是`settings.gradle`中定义的子项目。如果不是，当做单一项目编译，如果是按照多项目编译。

### 单一项目构建的配置和执行

对于单一项目的构建，初始化的工作流程相当简单。构建脚本在项目对象在初始阶段被建立后就会执行。然后 Gradle 寻找和在命令行中输入的参数同名的任务。如果这些任务存在，如果存在，就按照输入顺序分离执行。

### 对构建生命周期的响应

开发者的构建脚本会收到构建程序在生命周期的通知。这些通知通常有两种形式。开发者可以实现一个特别的监听者接口，或者提供一个闭包来执行通知触发时需要调用的函数。
